(()=>{"use strict";const e=e=>{const n=e.id.split("-");return{x:parseInt(n[2]),y:parseInt(n[1])}},n={r:"./images/black_rook.png",n:"./images/black_knight.png",b:"./images/black_bishop.png",q:"./images/black_queen.png",k:"./images/black_king.png",p:"./images/black_pawn.png",R:"./images/white_rook.png",N:"./images/white_knight.png",B:"./images/white_bishop.png",Q:"./images/white_queen.png",K:"./images/white_king.png",P:"./images/white_pawn.png"},t=(n,t,c,l)=>{const i=e(n),o=e(t);if(i.x===o.x&&i.y===o.y)return!1;if("pawn"===c){if("white"===l)return i.x===o.x&&i.y-1===o.y;if("black"===l)return i.x===o.x&&i.y+1===o.y}return!1};function c(e){for(let n=0;n<8;n++)for(let c=0;c<8;c++){const l=document.querySelector(`#cell-${n}-${c}`),i=e.querySelector(".piece").style.backgroundImage,o=i.includes("pawn")?"pawn":"unknown",r=i.includes("white")?"white":"black";t(e,l,o,r)&&l.classList.add("possibleMove")}}const l=e=>{if(window.selectedPiece){const n=e.currentTarget,{piece:c,fromCell:l,pieceType:i,pieceColor:o}=window.selectedPiece;if(n.querySelector(".piece").style.backgroundImage.includes("url"))return;if(!t(l,n,i,o))return void console.log("Illegal move");l.querySelector(".piece").style.backgroundImage="",n.querySelector(".piece").style.backgroundImage=c,n.querySelector(".piece").style.backgroundSize="contain",l.classList.remove("selected"),document.querySelectorAll(".cell.possibleMove").forEach((e=>e.classList.remove("possibleMove"))),window.selectedPiece=null}else{const n=e.currentTarget,t=n.querySelector(".piece").style.backgroundImage;if(t.includes("url")){n.classList.add("selected");const e=t.includes("pawn")?"pawn":"unknown",l=t.includes("white")?"white":"black";window.selectedPiece={piece:t,fromCell:n,pieceType:e,pieceColor:l},c(n)}}},i=function(e){for(let t=0;t<e.length;t++)for(let c=0;c<e[t].length;c++){let l=e[t][c];if(" "!==l){let e=document.querySelector(`#cell-${t}-${c} .piece`);e.style.backgroundImage=`url(${n[l]})`,e.style.backgroundSize="contain",e.style.backgroundRepeat="no-repeat"}}};(function(){let e=document.createElement("div");e.id="chess-board",document.body.appendChild(e);for(let n=0;n<8;n++)for(let t=0;t<8;t++){let c=document.createElement("div");c.className="cell "+(n%2^t%2?"light":"dark"),c.id=`cell-${n}-${t}`;let i=document.createElement("div");i.className="piece",c.appendChild(i),e.appendChild(c),c.addEventListener("click",l)}})(),i([["r","n","b","q","k","b","n","r"],["p","p","p","p","p","p","p","p"],[" "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "],[" "," "," "," "," "," "," "," "],["P","P","P","P","P","P","P","P"],["R","N","B","Q","K","B","N","R"]])})();